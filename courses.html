<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Checkout ‚Äî AstroYoga</title>
<link rel="stylesheet" href="style.css">
<script src="https://js.stripe.com/v3/"></script>
<style>
.checkout-page { min-height:100vh; background:linear-gradient(160deg,#F8F5FF 0%,#F0E8F5 100%); padding:8rem 2rem 4rem; }
.checkout-container { max-width:560px; margin:0 auto; }
.checkout-card { background:white; border-radius:8px; padding:2.5rem; box-shadow:0 10px 40px rgba(120,80,160,0.1); margin-bottom:1.5rem; }
.service-summary { display:flex; justify-content:space-between; align-items:center; padding:1rem 0; border-bottom:1px solid #f0e8f5; margin-bottom:1.5rem; }
.service-name { font-family:"Playfair Display",serif; font-size:1.2rem; color:var(--warm-brown); }
.service-price { font-family:"Playfair Display",serif; font-size:1.4rem; color:var(--purple); font-weight:600; }
.currency-toggle { display:flex; gap:0.5rem; margin-bottom:1.5rem; }
.currency-btn { padding:0.4rem 1rem; border:1px solid var(--purple-light); border-radius:20px; background:none; cursor:pointer; font-size:0.8rem; color:var(--purple); transition:all 0.2s; }
.currency-btn.active { background:var(--purple); color:white; }
.form-group { margin-bottom:1.2rem; }
.form-group label { display:block; font-size:0.75rem; letter-spacing:0.15em; text-transform:uppercase; color:var(--text-light); margin-bottom:0.5rem; }
.form-group input { width:100%; padding:0.85rem 1rem; border:1px solid #e0d5f0; border-radius:4px; font-family:"Jost",sans-serif; font-size:0.95rem; color:var(--text-dark); outline:none; transition:border 0.2s; box-sizing:border-box; }
.form-group input:focus { border-color:var(--purple); }
#card-element { padding:0.85rem 1rem; border:1px solid #e0d5f0; border-radius:4px; background:white; }
#card-element.StripeElement--focus { border-color:var(--purple); }
#card-errors { color:#e25555; font-size:0.82rem; margin-top:0.5rem; min-height:1.2rem; }
.pay-btn { width:100%; padding:1rem; background:linear-gradient(135deg,var(--purple),var(--rose)); color:white; border:none; border-radius:4px; font-family:"Playfair Display",serif; font-size:1.1rem; cursor:pointer; margin-top:1.5rem; transition:all 0.3s; letter-spacing:0.05em; }
.pay-btn:hover { opacity:0.9; transform:translateY(-1px); }
.pay-btn:disabled { opacity:0.6; cursor:not-allowed; transform:none; }
.secure-note { text-align:center; font-size:0.75rem; color:var(--text-light); margin-top:1rem; }
.back-link { display:inline-block; margin-bottom:2rem; color:var(--purple); font-size:0.85rem; text-decoration:none; }
.back-link:hover { text-decoration:underline; }

/* NOT ACTIVATED banner */
.demo-banner { background:linear-gradient(135deg,#2E1F3E,#4A2D5A); color:white; padding:1rem 1.5rem; border-radius:6px; margin-bottom:1.5rem; text-align:center; font-size:0.82rem; line-height:1.6; }
.demo-banner strong { color:var(--gold-light); display:block; margin-bottom:0.3rem; font-size:0.9rem; }

/* SUCCESS PAGE */
.success-page { display:none; text-align:center; padding:3rem 2rem; }
.success-icon { font-size:4rem; display:block; margin-bottom:1rem; }
</style>
</head>
<body>
<nav id="main-nav"><a href="index.html" class="logo">Astro<span>Yoga</span></a><ul class="nav-links"><li><a href="index.html">Home</a></li><li><a href="about.html">About</a></li><li><a href="services.html">Services</a></li><li><a href="booking.html" class="active">Book</a></li></ul><div style="display:flex;gap:0.8rem;align-items:center;"><div class="lang-toggle"><button class="lang-btn active" onclick="setLang('en')">EN</button><button class="lang-btn" onclick="setLang('es')">ES</button></div></div></nav>

<div class="checkout-page">
  <div class="checkout-container">

    <a href="booking.html" class="back-link">‚Üê Back to booking</a>

    <!-- Demo banner - remove once Stripe is activated -->
    <div class="demo-banner">
      <strong>‚ö° Payment coming soon</strong>
      This checkout is ready to go ‚Äî Stripe activation takes 10 minutes when you're ready. Contact Isidora to book in the meantime.
    </div>

    <!-- Checkout form -->
    <div id="checkout-form">
      <div class="checkout-card">
        <div class="service-summary">
          <div>
            <div class="service-name" id="service-name">Astral Healing</div>
            <div style="font-size:0.78rem;color:var(--text-light);margin-top:0.3rem;" id="service-duration">60 min ¬∑ Online</div>
          </div>
          <div>
            <div class="currency-toggle">
              <button class="currency-btn active" onclick="setCurrency('usd')">USD</button>
              <button class="currency-btn" onclick="setCurrency('clp')">CLP</button>
            </div>
            <div class="service-price" id="service-price">$150 USD</div>
          </div>
        </div>

        <div class="form-group">
          <label data-lang="en">Your Name</label>
          <label style="display:none;" data-lang="es">Tu Nombre</label>
          <input type="text" id="customer-name" placeholder="Isidora Castro">
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" id="customer-email" placeholder="hello@email.com">
        </div>

        <div class="form-group">
          <label data-lang="en">Card Details</label>
          <label style="display:none;" data-lang="es">Datos de Tarjeta</label>
          <div id="card-element"></div>
          <div id="card-errors"></div>
        </div>

        <button class="pay-btn" id="pay-btn" onclick="handlePayment()">
          <span data-lang="en">Complete Booking</span>
          <span style="display:none;" data-lang="es">Completar Reserva</span>
          <span id="pay-amount"> ¬∑ $150 USD</span>
        </button>
        <div class="secure-note">üîí Secure payment via Stripe ¬∑ SSL encrypted</div>
      </div>
    </div>

    <!-- Success state -->
    <div id="success-page" class="success-page checkout-card">
      <span class="success-icon">‚ú®</span>
      <h2 style="font-family:'Playfair Display',serif;color:var(--warm-brown);" data-lang="en">Booking Confirmed!</h2>
      <h2 style="font-family:'Playfair Display',serif;color:var(--warm-brown);display:none;" data-lang="es">¬°Reserva Confirmada!</h2>
      <p style="color:var(--text-mid);margin:1rem 0;" data-lang="en">Thank you! Isidora will be in touch within 24 hours to confirm your session time.</p>
      <p style="color:var(--text-mid);margin:1rem 0;display:none;" data-lang="es">¬°Gracias! Isidora se pondr√° en contacto dentro de las 24 horas para confirmar tu horario.</p>
      <a href="index.html" class="btn-primary" style="margin-top:1.5rem;" data-lang="en">Back to Home</a>
      <a href="index.html" class="btn-primary" style="margin-top:1.5rem;display:none;" data-lang="es">Volver al Inicio</a>
    </div>

  </div>
</div>

<script src="shared.js"></script>
<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// üîë STRIPE ACTIVATION ‚Äî paste your key here
// Get it from: dashboard.stripe.com/apikeys
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const STRIPE_PUBLIC_KEY = 'pk_live_YOUR_STRIPE_KEY_HERE';
const STRIPE_ACTIVATED = STRIPE_PUBLIC_KEY !== 'pk_live_YOUR_STRIPE_KEY_HERE';

// Services data
const services = {
  'astral-healing':     { name:'Astral Healing', name_es:'Sanaci√≥n Astral',    usd:150,  clp:100000, duration:'60 min' },
  'carta-astral':       { name:'Carta Astral',   name_es:'Carta Astral',       usd:98,   clp:70000,  duration:'75 min' },
  'revolucion-solar':   { name:'Revoluci√≥n Solar',name_es:'Revoluci√≥n Solar',  usd:85,   clp:60000,  duration:'60 min' },
  'reiki':              { name:'Reiki a Distancia',name_es:'Reiki a Distancia',usd:50,   clp:35000,  duration:'45 min' },
  'theta-healing':      { name:'Theta Healing',  name_es:'Theta Healing',      usd:70,   clp:50000,  duration:'50 min' },
};

// Read service from URL param
const params = new URLSearchParams(window.location.search);
const serviceKey = params.get('service') || 'astral-healing';
const service = services[serviceKey] || services['astral-healing'];
let currentCurrency = 'usd';

// Set service info
document.getElementById('service-name').textContent = service.name;
document.getElementById('service-duration').textContent = service.duration + ' ¬∑ Online';
updatePrice();

function setCurrency(currency) {
  currentCurrency = currency;
  document.querySelectorAll('.currency-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  updatePrice();
}

function updatePrice() {
  const price = currentCurrency === 'usd'
    ? '$' + service.usd + ' USD'
    : '$' + service.clp.toLocaleString() + ' CLP';
  document.getElementById('service-price').textContent = price;
  document.getElementById('pay-amount').textContent = ' ¬∑ ' + price;
}

// Init Stripe if activated
let stripe, elements, cardElement;
if (STRIPE_ACTIVATED) {
  stripe = Stripe(STRIPE_PUBLIC_KEY);
  elements = stripe.elements();
  cardElement = elements.create('card', {
    style: {
      base: { fontFamily: 'Jost, sans-serif', fontSize: '16px', color: '#1A1028' },
      invalid: { color: '#e25555' }
    }
  });
  cardElement.mount('#card-element');
  cardElement.on('change', e => {
    document.getElementById('card-errors').textContent = e.error ? e.error.message : '';
  });
} else {
  // Show demo card element placeholder
  document.getElementById('card-element').innerHTML =
    '<div style="color:#9080A8;font-size:0.85rem;padding:0.3rem 0;">Card fields will appear here once Stripe is activated</div>';
}

async function handlePayment() {
  if (!STRIPE_ACTIVATED) {
    alert('Payment not yet activated. Please contact Isidora to book your session.');
    return;
  }
  const name = document.getElementById('customer-name').value;
  const email = document.getElementById('customer-email').value;
  if (!name || !email) { alert('Please fill in your name and email.'); return; }

  const btn = document.getElementById('pay-btn');
  btn.disabled = true;
  btn.innerHTML = '‚è≥ Processing...';

  // In production: call your backend to create a PaymentIntent
  // For now show success (demo mode)
  setTimeout(() => {
    document.getElementById('checkout-form').style.display = 'none';
    document.getElementById('success-page').style.display = 'block';
  }, 1500);
}
</script>
</body>
</html>
